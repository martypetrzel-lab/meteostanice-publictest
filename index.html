<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>Meteostanice â€“ mozek v akci</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    :root {
      --bg: #0b1220;
      --card: #101a2f;
      --text: #e6ecff;
      --muted: #8fa2d9;
      --accent: #4da3ff;
      --good: #4caf50;
      --warn: #ff9800;
      --bad: #f44336;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu;
      background: radial-gradient(circle at top, #14204a, #060b18);
      color: var(--text);
    }

    header {
      padding: 24px 32px;
      font-size: 28px;
      font-weight: 700;
    }

    main {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 24px;
      padding: 0 32px 32px;
    }

    .card {
      background: linear-gradient(180deg, #121d36, #0b1326);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,.35);
    }

    .card h2 {
      margin: 0 0 16px;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .row {
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
      font-size: 16px;
    }

    .label {
      color: var(--muted);
    }

    .value {
      font-weight: 600;
    }

    .fan-on { color: var(--warn); }
    .fan-off { color: var(--muted); }

    .verdict {
      margin-top: 12px;
      font-size: 15px;
      line-height: 1.5;
      padding: 12px;
      border-radius: 12px;
      background: rgba(255,255,255,0.05);
    }

    footer {
      padding: 16px 32px;
      color: var(--muted);
      font-size: 13px;
    }
  </style>
</head>

<body>

<header>ğŸŒ¦ï¸ Meteostanice â€“ mozek v akci</header>

<main>

  <!-- PROSTÅ˜EDÃ -->
  <section class="card">
    <h2>ğŸŒ ProstÅ™edÃ­</h2>
    <div class="row">
      <div class="label">SvÄ›tlo</div>
      <div class="value"><span id="light">â€“</span> lx</div>
    </div>
    <div class="row">
      <div class="label">Teplota</div>
      <div class="value"><span id="temp">â€“</span> Â°C</div>
    </div>
  </section>

  <!-- ENERGIE -->
  <section class="card">
    <h2>ğŸ”‹ Energie</h2>
    <div class="row">
      <div class="label">SOC</div>
      <div class="value"><span id="soc">â€“</span> %</div>
    </div>
    <div class="row">
      <div class="label">ZÃ¡tÄ›Å¾</div>
      <div class="value"><span id="load">â€“</span> W</div>
    </div>
  </section>

  <!-- VÄšTRÃK -->
  <section class="card">
    <h2>ğŸŒ€ VÄ›trÃ¡k</h2>
    <div class="row">
      <div class="label">Stav</div>
      <div class="value" id="fan">â€“</div>
    </div>
  </section>

  <!-- MOZEK -->
  <section class="card">
    <h2>ğŸ§  Mozek â€“ rozhodnutÃ­</h2>
    <div class="verdict" id="verdict">â€“</div>
  </section>

</main>

<footer>
  Data jsou Ätena vÃ½hradnÄ› ze <code>/state</code> â€¢ aktualizace kaÅ¾dou 1 s
</footer>

<script>
async function updateUI() {
  try {
    const res = await fetch("/state");
    const state = await res.json();

    // ProstÅ™edÃ­
    document.getElementById("light").innerText =
      state.world?.environment?.light ?? "â€“";

    document.getElementById("temp").innerText =
      state.world?.environment?.temperature ?? "â€“";

    // Energie
    document.getElementById("soc").innerText =
      state.energy?.soc ?? "â€“";

    document.getElementById("load").innerText =
      state.energy?.load ?? "â€“";

    // VÄ›trÃ¡k
    const fanEl = document.getElementById("fan");
    if (state.device?.fan) {
      fanEl.innerText = "ZAPNUTÃ";
      fanEl.className = "value fan-on";
    } else {
      fanEl.innerText = "VYPNUTÃ";
      fanEl.className = "value fan-off";
    }

    // Mozek
    document.getElementById("verdict").innerText =
      state.brain?.verdict ?? "â€“";

  } catch (e) {
    console.error("STATE ERROR", e);
  }
}

setInterval(updateUI, 1000);
updateUI();
</script>

</body>
</html>
