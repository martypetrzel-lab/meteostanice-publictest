<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meteostanice – Dashboard</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="app">
    <header class="top">
      <div class="brand">
        <div class="logo">☀️</div>
        <div>
          <div class="title">Meteostanice</div>
          <div class="subtitle">
            <span id="statusText">Dashboard • načítám…</span>
            <span class="dot">•</span>
            <a id="stateLink" href="#" target="_blank" rel="noreferrer">/state</a>
          </div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="today">DNES</button>
        <button class="tab" data-tab="history">HISTORIE</button>
        <button class="tab" data-tab="energy">ENERGIE</button>
        <button class="tab" data-tab="settings">NASTAVENÍ</button>
      </div>
    </header>

    <main class="content">
      <!-- DNES -->
      <section class="panel active" id="tab-today">
        <div class="grid2">
          <div class="card">
            <div class="card-h">Prostředí</div>
            <div class="kv">
              <div class="k">Světlo</div><div class="v"><span id="uiLight">—</span> lx</div>
              <div class="k">Teplota</div><div class="v"><span id="uiTemp">—</span> °C</div>
              <div class="k">Vlhkost</div><div class="v"><span id="uiHum">—</span> %</div>
            </div>
            <div class="chips" id="uiWeatherChips"></div>
          </div>

          <div class="card">
            <div class="card-h">Energie</div>
            <div class="kv">
              <div class="k">SOC</div><div class="v"><span id="uiSoc">—</span> %</div>
              <div class="k">Solár</div><div class="v"><span id="uiSolar">—</span> W</div>
              <div class="k">Zátěž</div><div class="v"><span id="uiLoad">—</span> W</div>
              <div class="k">Větrák</div><div class="v"><span id="uiFan">—</span></div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">Mozek – rozhodnutí</div>

          <div class="brainTop">
            <div class="brainMsg">
              <div class="msg" id="uiMsg">—</div>
              <div class="msgSub" id="uiDetails">—</div>
            </div>
            <div class="brainBadge" id="uiModeBadge">NORMAL</div>
          </div>

          <div class="brainGrid">
            <div class="brainMetric">
              <div class="label">Riziko</div>
              <div class="value"><span id="uiRisk">—</span> / 100</div>
              <div class="bar"><div class="barFill" id="uiRiskBar"></div></div>
            </div>

            <div class="brainMetric">
              <div class="label">Výdrž</div>
              <div class="value"><span id="uiBatHours">—</span> h</div>
              <div class="hint" id="uiBatHint">—</div>
            </div>

            <div class="brainMetric">
              <div class="label">Slunce</div>
              <div class="value" id="uiSunLine">—</div>
              <div class="hint" id="uiSunHint">—</div>
            </div>

            <div class="brainMetric">
              <div class="label">Trend rizika</div>
              <canvas id="riskCanvas" width="640" height="140"></canvas>
              <div class="hint">Poslední ~2 hodiny (lokálně v prohlížeči)</div>
            </div>
          </div>

          <div class="chips" id="uiBrainChips"></div>
        </div>
      </section>

      <!-- HISTORIE -->
      <section class="panel" id="tab-history">
        <div class="card">
          <div class="card-h">Historie (poslední dny)</div>
          <div class="muted">Zobrazuje to, co backend posílá v <code>memory.days</code>.</div>
          <pre class="pre" id="uiHistory">—</pre>
        </div>

        <div class="card">
          <div class="card-h">Týdny</div>
          <div class="muted">Pokud backend posílá <code>memory.weeks</code>, zobrazí se agregace.</div>
          <pre class="pre" id="uiWeeks">—</pre>
        </div>
      </section>

      <!-- ENERGIE -->
      <section class="panel" id="tab-energy">
        <div class="card">
          <div class="card-h">Tok energie</div>
          <div class="energyFlow">
            <div class="flowBox">
              <div class="flowLabel">Solár</div>
              <div class="flowValue"><span id="uiSolar2">—</span> W</div>
            </div>
            <div class="flowArrow">➡️</div>
            <div class="flowBox">
              <div class="flowLabel">Baterie</div>
              <div class="flowValue"><span id="uiSoc2">—</span> %</div>
            </div>
            <div class="flowArrow">➡️</div>
            <div class="flowBox">
              <div class="flowLabel">Zátěž</div>
              <div class="flowValue"><span id="uiLoad2">—</span> W</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">Predikce</div>
          <div class="kv">
            <div class="k">Net</div><div class="v"><span id="uiNet">—</span> W</div>
            <div class="k">Výdrž</div><div class="v"><span id="uiBatHours2">—</span> h</div>
            <div class="k">Dnes solár</div><div class="v"><span id="uiTodaySolarWh">—</span> Wh</div>
          </div>
          <div class="muted">Zobrazuje se jen když backend posílá <code>prediction</code>.</div>
        </div>
      </section>

      <!-- NASTAVENÍ -->
      <section class="panel" id="tab-settings">
        <div class="card">
          <div class="card-h">⚙️ Nastavení UI</div>

          <div class="kv">
            <div class="k">Backend URL</div>
            <div class="v">
              <input id="backendUrl" class="input" placeholder="https://...railway.app" />
            </div>

            <div class="k"></div>
            <div class="v row">
              <button id="btnSave" class="btn">Uložit</button>
              <button id="btnTest" class="btn ghost">Test /health</button>
              <span id="healthOut" class="muted">—</span>
            </div>

            <div class="k">Refresh</div>
            <div class="v row">
              <button class="chipBtn" data-interval="1000">1s</button>
              <button class="chipBtn" data-interval="2000">2s</button>
              <button class="chipBtn" data-interval="5000">5s</button>
              <label class="check">
                <input id="chkRaw" type="checkbox" />
                <span>Zobrazit RAW JSON</span>
              </label>
            </div>
          </div>

          <div class="muted">
            Tip: GitHub Pages automaticky použije tvůj Railway backend. Když chceš přepnout, napiš ho sem.
          </div>

          <pre class="pre hidden" id="rawJson">—</pre>
        </div>
      </section>
    </main>

    <footer class="foot">
      UI prototype • data z /state • ©
    </footer>
  </div>

  <script src="./app.js"></script>
</body>
</html>
